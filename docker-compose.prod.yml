# Production override - uses Akamai/Linode S3 instead of local MinIO
# Usage: docker compose -f docker-compose.yml -f docker-compose.prod.yml up -d

services:
  # Disable MinIO in production
  minio:
    profiles:
      - disabled

  minio-init:
    profiles:
      - disabled

  backend:
    environment:
      - REDIS_URL=redis://redis:6379/0
      - S3_ENDPOINT=${S3_ENDPOINT}
      - S3_ACCESS_KEY=${S3_ACCESS_KEY}
      - S3_SECRET_KEY=${S3_SECRET_KEY}
      - S3_BUCKET=${S3_BUCKET}
      - S3_REGION=${S3_REGION}
      - S3_PUBLIC_URL=${S3_PUBLIC_URL}
    depends_on:
      redis:
        condition: service_healthy

  worker:
    environment:
      - REDIS_URL=redis://redis:6379/0
      - S3_ENDPOINT=${S3_ENDPOINT}
      - S3_ACCESS_KEY=${S3_ACCESS_KEY}
      - S3_SECRET_KEY=${S3_SECRET_KEY}
      - S3_BUCKET=${S3_BUCKET}
      - S3_REGION=${S3_REGION}
      - S3_PUBLIC_URL=${S3_PUBLIC_URL}
    depends_on:
      redis:
        condition: service_healthy
